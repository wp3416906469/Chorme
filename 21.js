(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{125:function(e,t,n){"use strict";n.r(t);n(37),n(223),n(26),n(22),n(167),n(28),n(39),n(60),n(72),n(266),n(42),n(17),n(24),n(32);var r=n(36),o=n(61),a=n(11);function i(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s="https://bizapi.csdn.net/searchplugin",f=a.j&&chrome.runtime&&chrome.runtime.getManifest?chrome.runtime.getManifest():{},d={uploadScreenShot(e){var t=new FormData;return t.append("file",e),r.a.post("".concat(s,"/api/v1/image/upload"),t,{headers:{"Content-Type":"multipart/form-data","X-Ca-Signed-Content-Type":"multipart/form-data"}})},upload:e=>r.a.post("".concat(s,"/api/v1/custom/plugin/add"),e,{headers:{"Content-Type":"application/json; charset=UTF-8"}}),downloadPlugin:e=>r.a.post("".concat(s,"/api/v1/custom/plugin/download"),e,{headers:{"Content-Type":"application/json; charset=UTF-8"}}),upadate:e=>r.a.post("".concat(s,"/api/v1/custom/plugin/list/new"),e,{headers:{"Content-Type":"application/json; charset=UTF-8"}}),list(e){var t=Object(r.b)(l({version:f.version||""},e));return r.a.get("".concat(s,"/api/v2/custom/plugin/list?").concat(t))},download:e=>new Promise((function(t){d.downloadPlugin({pluginId:e}).then((function(e){var n,r,a,i,c,u=e.code,p=e.data;if(200===u){var s,f,d,g,m,b={};if("iframe"!==p.type&&p.type||(p.type||(p.type="iframe"),(b=["name","height","url","triggerWord","canDelete","description","defaultEnable","placeholder","id","type","createUser","createTime","updateTime","pluginId"].reduce((function(e,t){return l(l({},e),{},{[t]:["canDelete","defaultEnable"].indexOf(t)>-1?1===p[t]:p[t]})}),{})).pluginId=b.pluginId||o.a.getPluginId()),"inject"!==p.type&&"webPage"!==p.type||(b=l(l({},p),{},{description:p.description||"",canDelete:1===p.canDelete,defaultEnable:1===p.defaultEnable})),b.enable=!0,b.content=JSON.parse(p.content),b.createTime=dayjs().format("YYYY-MM-DD HH:mm:ss"),null!==(n=b)&&void 0!==n&&null!==(r=n.content)&&void 0!==r&&r.screenShots)b.screenShots=null===(s=b)||void 0===s||null===(f=s.content)||void 0===f?void 0:f.screenShots,delete b.content.screenShots;else b.screenShots=[];if("iframe"!==p.type&&p.type||b.url||(b=l(l(l({},b),b.content),{},{content:{}})),null!==(a=b)&&void 0!==a&&null!==(i=a.content)&&void 0!==i&&i.logo||null!==(c=b)&&void 0!==c&&c.logo)b.logo=(null===(d=b)||void 0===d||null===(g=d.content)||void 0===g?void 0:g.logo)||(null===(m=b)||void 0===m?void 0:m.logo),delete b.content.logo;else b.logo="";if("webPage"===p.type){var y,v,h=Object.prototype.hasOwnProperty;b.url=chrome.runtime.getURL("pages/dynamicPlugin.html?pluginId=")+p.pluginId;var O=h.call(b.content,"openIsIframe");b.openIsIframe=!O||(null===(y=b)||void 0===y||null===(v=y.content)||void 0===v?void 0:v.openIsIframe),O&&delete b.content.openIsIframe}t({code:u,data:b})}else t({code:u,message:"下载失败"})})).catch((function(e){t({code:0,data:e})}))})),enable(e){var t=chrome.extension.getBackgroundPage().Settings,n=t.get("iframeMap")||[],r=Object.keys(n).map((function(e){return l(l({},n[e]),{},{pluginId:n[e].pluginId||o.a.getPluginId(),triggerWord:e})})),a=t.get("webPagesMap")||[],i=r.findIndex((function(t){return t.pluginId===e}));if(i>-1){r[i].enable=!0;var c=r.filter((function(e){return"iframe"===e.type||!e.type})).reduce((function(e,t){return e?l(l({},e),{},{[t.triggerWord]:t}):{[t.triggerWord]:t}}),"");return t.set("iframeMap",c),r[i]}var u=a.findIndex((function(t){return t.pluginId===e}));if(u>-1)return a[u].enable=!0,t.set("webPagesMap",a),a[u]},add(e){var t=chrome.extension.getBackgroundPage().Settings;if("webPage"===e.type){var n=t.get("webPagesMap")||[];t.set("webPagesMap",[].concat(i(n),[e]).sort((function(e,t){var n=e.createTime||"1970/01/01",r=t.createTime||"1970/01/01";return+new Date(r)-+new Date(n)})))}if("iframe"===e.type){var r=t.get("iframeMap")||[],a=Object.keys(r).map((function(e){return l(l({},r[e]),{},{pluginId:r[e].pluginId||o.a.getPluginId(),triggerWord:e})})),c=[].concat(i(a),[e]).sort((function(e,t){var n=e.createTime||"1970/01/01",r=t.createTime||"1970/01/01";return+new Date(r)-+new Date(n)})).filter((function(e){return"iframe"===e.type||!e.type})).reduce((function(e,t){return e?l(l({},e),{},{[t.triggerWord]:t}):{[t.triggerWord]:t}}),"");t.set("iframeMap",c)}}};t.default=d},61:function(e,t,n){"use strict";n(37),n(26),n(22),n(28),n(60),n(72),n(97),n(42),n(17),n(371),n(90),n(41),n(51),n(114),n(283),n(32);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i=function(e){for(var t=[],n=["0","1","2","3","4","5","6","7","8","9"],r=0;r<e;r++){var o=Math.floor(10*Math.random());t[r]=n[o]}return t.join("")};t.a={parseLines:function(e){return e.replace(/\\\n/g,"").split("\n").map((function(e){return e.trim()})).filter((function(e){return e.length>0}))},parseToTxt:function(e){return""},hasFullUrlPrefix:function(e){return new RegExp("^[a-z][-+.a-z0-9]{2,}://.").test(e)},hasJavascriptPrefix:function(e){return e.startsWith("javascript:")},urlParamsToObj:function(e){var t={};return e.replace(/([^?&=]+)=([^?&=]+)/g,(function(){t[arguments[1]]=arguments[2]})),t},objToUrlParams:function(e){var t="";return $.each(e,(function(n){t+="&"+n+"="+e[n]})),t.substr(1)},parseKeyValue:e=>"Array"!==Object.prototype.toString.call(e).slice(8,-1)?[]:e.reduce((function(e,t){var n=t.replace(/\s+/g,"").split(":"),r=n[0],a=n[1].split(",").reduce((function(e,t){return e?o(o({},e),{},{[t]:r}):{[t]:r}}),"");return e?o(o({},e),a):a}),""),getPluginId:e=>"CSDNPlugin-".concat(e?e+"_":"").concat(i(8),"-").concat(+new Date,"-").concat(i(8))}}}]);