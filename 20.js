(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{1183:function(e,t,a){},1212:function(e,t,a){"use strict";a(1183)},1239:function(e,t,a){"use strict";a.r(t);a(37),a(22),a(28),a(42),a(32);var r=a(49),n=(a(50),a(60),a(17),a(24),a(115),a(75),a(25)),o=a(11);function c(e,t,a,r,n,o,c){try{var s=e[o](c),i=s.value}catch(e){return void a(e)}s.done?t(i):Promise.resolve(i).then(r,n)}function s(e){return function(){var t=this,a=arguments;return new Promise((function(r,n){var o=e.apply(t,a);function s(e){c(o,r,n,s,i,"next",e)}function i(e){c(o,r,n,s,i,"throw",e)}s(void 0)}))}}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var p={data:()=>({rollbackData:"",avatar:"",loadingBackup:!0,loadingBackupAuto:!0,backupData:{},backupDataAuto:{}}),computed:u({},Object(r.c)({tabSettings:"config/tab-settings",userInfo:"user/userInfo"})),created(){this.userInfo.UserName&&!this.backupData.createTime&&this.getBackUpData(),this.getRollbackData()},methods:u(u({},Object(r.b)("weatherStore",{refreshWeatherData:"refreshWeatherData"})),{},{getPopupContainer:e=>e.parentElement,logout(){var e=this;if(o.j){var t=["UserToken","UserInfo","UserName","AU","UserNick"].map((function(t){return e.removeCookie(t)}));Promise.all(t).then((function(e){location.reload()}))}else{var a="https://passport.csdn.net/account/logout?from="+encodeURIComponent(location.href),r=document.createElement("a");r.href=a,r.setAttribute("target","_self"),r.click()}},removeCookie:e=>new Promise((function(t){chrome.cookies.remove({url:"https://csdn.net",name:e},t)})),getBackUpData(){var e=this;this.loadingBackup=!0,n.a.getRecoveryData().then((function(t){setTimeout((function(){e.loadingBackup=!1}),300),e.backupData=t}));!function t(){e.loadingBackupAuto=!0,e.backupDataAuto={},n.a.getRecoveryData(1).then((function(t){setTimeout((function(){e.loadingBackupAuto=!1}),300),e.backupDataAuto=t})),window.setTimeout(t,305e3)}()},backUpData(){var e=arguments,t=this;return s(regeneratorRuntime.mark((function a(){var r,o,c,s,i;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=e.length>0&&void 0!==e[0]?e[0]:0,!t.userInfo.UserName){a.next=10;break}return o=t.$message.loading("备份中...",0),a.next=5,n.a.backup(r);case 5:c=a.sent,s=c.code,i=c.data,setTimeout((function(){o()}),300),setTimeout((function(){200===s?(t.$message.success("备份成功"),t.getBackUpData()):(console.error({code:s,data:i}),t.$message.error("备份失败"))}),600);case 10:case"end":return a.stop()}}),a)})))()},recoveryData(){var e=arguments,t=this;return s(regeneratorRuntime.mark((function a(){var r,o;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=e.length>0&&void 0!==e[0]?e[0]:0,!t.userInfo.UserName||""===t.backupData.id){a.next=9;break}return o=t.$message.loading("恢复中...",0),a.next=5,n.a.recovery(null,r);case 5:t.getRollbackData(),t.refreshWeatherData(),setTimeout((function(){o()}),300),setTimeout((function(){t.$message.success("恢复成功")}),600);case 9:case"end":return a.stop()}}),a)})))()},rollback(){n.a.rollback()},getRollbackData(){this.rollbackData=n.a.get("tab-rollback")}})},f=(a(1212),a(8));function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function m(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var b={data:()=>({}),components:{UserCard:Object(f.a)(p,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user-info-card"},[a("img",{staticClass:"avatar",attrs:{src:e.userInfo.avatar,alt:""}}),e._v(" "),a("p",[e._v(e._s(e.userInfo.UserNick))]),e._v(" "),a("h3",[e._v("\n    账户与备份\n    "),e.userInfo.UserName?a("div",{staticClass:"logout-img",on:{click:function(t){return e.logout()}}}):e._e()]),e._v(" "),a("ul",[e.userInfo.UserName?a("li",[a("div",{staticClass:"line-item"},[a("div",[e._v("当前登录账户：")]),e._v(" "),a("div",[e._v(e._s(e.userInfo.UserNick))])])]):e._e(),e._v(" "),e.userInfo.UserName?a("li",[a("div",{staticClass:"line-item"},[a("div",[e._v("上次手动备份时间:")]),e._v(" "),a("div",[e.backupData.createTime?a("span",[e._v(" "+e._s(e.backupData.createTime))]):e.loadingBackup?a("span",[e._v("加载中...")]):a("span",[e._v("无备份数据")]),e._v(" "),a("a-popconfirm",{attrs:{title:"您确定要恢复数据吗？",overlayClassName:"user-info-card-popover",cancelText:"取消",placement:"left",okText:"确认","get-popup-container":e.getPopupContainer},on:{confirm:function(t){return e.recoveryData()}}},[a("div",{staticClass:"btn-backup"},[e._v("恢复")])])],1)])]):e._e(),e._v(" "),e.userInfo.UserName?a("li",[a("div",{staticClass:"line-item"},[a("div",[e._v("上次自动备份时间:")]),e._v(" "),a("div",[e.backupDataAuto.createTime?a("span",[e._v(" "+e._s(e.backupDataAuto.createTime))]):e.loadingBackupAuto?a("span",[e._v("加载中...")]):a("span",[e._v("无备份数据")]),e._v(" "),a("a-popconfirm",{attrs:{title:"您确定要恢复数据吗？",overlayClassName:"user-info-card-popover",cancelText:"取消",placement:"left",okText:"确认","get-popup-container":e.getPopupContainer},on:{confirm:function(t){return e.recoveryData(1)}}},[a("div",{staticClass:"btn-backup"},[e._v("恢复")])])],1)])]):e._e(),e._v(" "),!e.userInfo.UserName||e.loadingBackup||e.loadingBackupAuto?e._e():a("li",{staticClass:"last-child"},[a("a-popconfirm",{attrs:{title:"您确定要备份吗？",overlayClassName:"user-info-card-popover",cancelText:"取消",okText:"确认","get-popup-container":e.getPopupContainer},on:{confirm:function(t){return e.backUpData()}}},[a("button",{staticClass:"btn data-backups"},[e._v("立即备份")])]),e._v(" "),e.rollbackData?a("a-popconfirm",{attrs:{title:"您确定要回滚数据吗？",overlayClassName:"user-info-card-popover",cancelText:"取消",okText:"确认","get-popup-container":e.getPopupContainer},on:{confirm:function(t){return e.rollback()}}},[a("button",{staticClass:"btn data-recovery"},[e._v("回滚")])]):e._e()],1)])])}),[],!1,null,null,null).exports},methods:{login(){o.j&&(chrome.cookies.remove({url:"https://csdn.net",name:"c_first_page"},(function(e){})),chrome.cookies.set({url:"https://csdn.net",name:"c_first_ref",value:"default"},(function(e){}))),location.href=o.j?"https://passport.csdn.net/login?code=public&platform=plugin":"https://passport.csdn.net/account/login"}},computed:function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){m(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},Object(r.c)({userInfo:"user/userInfo"}))},g=Object(f.a)(b,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",[this.userInfo.UserName?t("a-popover",{attrs:{overlayClassName:"user-info-popover",overlayStyle:{"margin-right":"10px"},title:"",trigger:"hover",placement:"left"}},[t("template",{slot:"content"},[t("BlurGrass",{attrs:{firefox:""}}),this._v(" "),t("UserCard")],1),this._v(" "),t("div",{staticClass:"user-icon login",style:{"background-image":"url("+this.userInfo.avatar+")"}})],2):t("a-tooltip",{attrs:{placement:"bottom",title:"未登录"}},[t("div",{staticClass:"user-icon",on:{click:this.login}})])],1)}),[],!1,null,null,null);t.default=g.exports}}]);